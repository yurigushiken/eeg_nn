# Temporal Generalization — within-prime=1 (change-only), ACC==1 — FULL RUN (config)
#
# "Full run" means:
# - all valid prime=1 transitions (12,13,14) => 3 binary pairs
# - all train windows across the epoch (50ms window, 20ms stride)
# - temporal-generalization evaluation across all test windows
#
# Seeds can be edited later (e.g., add 50) while keeping the same output dir.

model_name: eegnex
optuna_objective: inner_mean_min_per_class_f1

# Single seed for now (edit later if desired)
seeds: [49]

# Data
materialized_dir: data_preprocessed/hpf_1.5_lpf_35_baseline-on-avgref
exclude_channel_list: non_scalp
trial_filter: acc1
crop_ms: null

# Explicit condition codes (prime fixed to 1; targets 2–4)
rsa_conditions: [12, 13, 14]

temporal:
  epoch_ms: 500
  window_ms: 50
  stride_ms: 20

temporal_generalization:
  enabled: true
  write_predictions: true

# Training schedule
epochs: 100
early_stop: 20
batch_size: 128
lr: 0.001
inner_n_folds: 5
n_folds: 6
outer_eval_mode: ensemble

# Regularization
weight_decay: 0.000025
drop_prob: 0.5
scheduler_patience: 5
lr_warmup_frac: 0.0
lr_warmup_init: 0.0

# EEGNeX architecture (50ms windows safe pooling)
filter_1: 8
filter_2: 32
kernel_block_1_2: 32
kernel_block_4: 16
kernel_block_5: 16
avg_pool_block4: 4
avg_pool_block5: 4
dilation_block_4: 2
dilation_block_5: 4
depth_multiplier: 2
activation: elu
max_norm_conv: 1.0
max_norm_linear: 0.25

dataset_cache_memory: true


# cd D:\eeg_nn; conda run -n eegnex-env python -X utf8 -u scripts\rsa\run_temporal_decoding.py --config configs\tasks\rsa\rsa_temporal_generalization_prime1_acc1_full.yaml --output-dir results\runs\rsa_temporal_generalization_prime1_acc1_seed49_v1 --task rsa_binary --engine eeg